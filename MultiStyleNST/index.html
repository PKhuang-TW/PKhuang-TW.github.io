<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>PKhuang</title><meta name="author" content="PoKai Huang"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/user.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 5.4.2"></head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">PKhuang</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/Resume/"> Resume</a></li><li class="menus_item"><a class="site-page" href="/Thesis/"> Thesis</a></li><li class="menus_item"><a class="site-page" href="/Projects/"> Projects</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/myPhoto.jpg" onerror="this.onerror=null;this.src='/img/profile.png'" alt="avatar"></div><div class="author-discrip"><h3>PoKai Huang</h3><p class="author-bio">I am a passionate person and I love to take on challenges. Familiar with C/C++ and Python. I graduateed from NCTU in 2020, and have 3 years working experience as a FW engineer in SiliconMotion.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-links"><li><a class="e-social-link" href="tel:0932732142" target="_blank"><i class="fas fa-phone-alt" aria-hidden="true"></i><span>0932-732-142</span></a></li><li><a class="e-social-link" href="mailto:pokaihuang.tw@gmail.com" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i><span>pokaihuang.tw@gmail.com</span></a></li><li><a class="e-social-link" href="https://github.com/PKhuang-TW/" target="_blank"><i class="fab fa-github" aria-hidden="true"></i><span>https://github.com/PKhuang-TW</span></a></li><li><a class="e-social-link" href="/" target="_blank"><i class="fas fa-map-marker-alt" aria-hidden="true"></i><span>Hsinchu, TW</span></a></li></ul></div><a class="cv-links" href="/attaches/PKHuang_Resume.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>My Resume</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title"></h2><article><div>
    <h1 style="display:inline;"> Multi-Style Semantic Style Transfer </h1> 
    <a target="_blank" rel="noopener" href="https://github.com/PKhuang-TW/MultiStyle-Semantic-Style-Transfer"> [Code] </a> 
</div>

<hr>
<p>This project is aimed to transfer different semantic objects in one image into different styles. We use pretrained semantic segmentation model (DeepLab-V3) to get the foregound and backgound region, and apply style transfer on different style for each region. In addition to style loss and content loss in traditional neural style transfer, we futher add style-blending loss and total variance loss to make the result more harmony when blending very different style. Also, we provide custom control of blending effect. </p>
<h2 id="Model-Architecture"><a href="#Model-Architecture" class="headerlink" title="Model Architecture"></a>Model Architecture</h2><img src = "./imgs/model_architecture.png" class="projectDetailImg">
Given one image I<sub>src</sub> and two target style images I<sub>s1</sub> and I<sub>s2</sub>, we want to transfer different semantic objects into different style accrodingly. We first produced two intermediated result image I<sub>i1</sub> and I<sub>i2</sub>, and compute the style loss between (I<sub>s1</sub>, I<sub>i1</sub>) and (I<sub>s2</sub>, I<sub>i2</sub>). The we merge these two intermediated images into final result image I<sub>result</sub> by semantic map predicted by DeepLab-V3 image. Finally compute the content loss between (I<sub>src</sub>, I<sub>result</sub>). Further more, to make the resulting image more harmony while blending different styles and prevent weird boundary after merging two intermediated images, we also compute the style-blending loss which is weighted style loss between (I<sub>s1</sub>, I<sub>i2</sub>) and (I<sub>s2</sub>, I<sub>i1</sub>), and smooth loss which is total variance of I<sub>result</sub>. The entire loss function can be written as follow:<br/>
L = &lambda;<sub>1</sub>L<sub>style</sub> + &lambda;<sub>2</sub>L<sub>blend</sub> + &lambda;<sub>3</sub>L<sub>content</sub> + &lambda;<sub>4</sub>L<sub>Smooth</sub>
&nbsp;

<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><h3 id="Compare-with-naive-approach"><a href="#Compare-with-naive-approach" class="headerlink" title="Compare with naive approach"></a>Compare with naive approach</h3><img src = "./imgs/compare.png" class="projectDetailImg">
To validate the effectiveness of additional loss function, we compare the result from removing both blending and smooth loss (left figure), the result from removing smooth loss (mid figure) and the result from using all loss function mentioned above (right figure). From the result we can observe that the naive method will result in weird boundary between different semantic objects. After adding the blending loss, this artifact would improve a lot, and the result of boundary is most clean if all loss function is applied. However, after adding the smooth loss, the resulting image will loss some detail of style (e.g., little spot and stripe). We consider it is an tradeoff between less artifact at boundary and more detail in style, and the effect can be control through adjust the weight of smooth loss.
<p>

<h3 id="Style-Blending-Ratio"><a href="#Style-Blending-Ratio" class="headerlink" title="Style Blending Ratio"></a>Style Blending Ratio</h3><img src = "./imgs/blending.png" class="projectDetailImg">
Furthermore, we observe that using naive method sometimes cause the resulting image to become very disharmonious if the two target style is very different (the first figure). After adding the style blending loss, the resulting will become much harmonious (the last figure). However, when the weight of blending loss become too large, it become hard to distinguish different style in different semantic object. So again, we consider it is a tradeoff between making the resulting image more distinguishable to different style and more harmonious.
<p>

<h3 id="Sample-Result"><a href="#Sample-Result" class="headerlink" title="Sample Result"></a>Sample Result</h3><p><img src="./imgs/result_1.png" width="40%"> <img src="./imgs/result_2.png" width="40%"></p>
<p>

<h3 id="Video-Style-Transfer"><a href="#Video-Style-Transfer" class="headerlink" title="Video Style Transfer"></a>Video Style Transfer</h3><img src = "./imgs/model_video.png" class="projectDetailImg"> 
Traditional neural style transfer use <b>On-line Image Optimization</b> approach, but it could take long time if we want to transfer many image (In our environment, optimize an image take a few minutes). To transfer a video that contain hundred of even thousand of frames, we first use <b>Off-line Model optimization</b> approach to train a transfer model, the for each frame in the video, we can feed it into model and get the resulting image in a few second, whcih make transfer style of video become more practicable. <br/>
<img src="./imgs/video_1.gif" width="40%"> <img src="./imgs/video_2.gif" width="40%"> <br/>

</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/Resume/"> Resume</a></li><li class="nav_item"><a class="nav-page" href="/Thesis/"> Thesis</a></li><li class="nav_item"><a class="nav-page" href="/Projects/"> Projects</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2020 - 2024 by PoKai Huang</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>